<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Advanced plotting • tidyplots</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Advanced plotting">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidyplots</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/tidyplots.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Visualizing-data.html">Visualizing data</a></li>
    <li><a class="dropdown-item" href="../articles/Advanced-plotting.html">Advanced plotting</a></li>
    <li><a class="dropdown-item" href="../articles/Color-schemes.html">Color schemes</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jbengler/tidyplots/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Advanced plotting</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jbengler/tidyplots/blob/master/vignettes/articles/Advanced-plotting.Rmd" class="external-link"><code>vignettes/articles/Advanced-plotting.Rmd</code></a></small>
      <div class="d-none name"><code>Advanced-plotting.Rmd</code></div>
    </div>

    
    
<div class="lead">
<p>In this article, we will explore advanced plotting techniques offered
in tidyplots. We will cover the rasterization of plot components, data
subsetting for highlighting selected data points, and the construction
of powerful plotting pipelines. Moreover, we will discuss the
visualization of paired and missing data, generate multiplot layouts and
introduce the concepts of plot orientation, dodging, coloring, plot area
padding, and more. We will conclude by discussing the compatibility of
tidyplots with ggplot2.</p>
</div>
<div class="section level2">
<h2 id="rasterization">Rasterization<a class="anchor" aria-label="anchor" href="#rasterization"></a>
</h2>
<p>Generally, vector graphics like PDF and SVG are superior to raster
images like PNG and JPG because they maintain high quality and sharpness
at any scale. This makes them ideal for printing, resizing, and zooming
without losing detail.</p>
<p>However, in plots with many data points, such as busy scatter plots
or heatmaps, the presence of too many vector shapes can slow down
performance without providing extra information. In these cases,
rasterization of individual layers of the plot can be beneficial, as it
reduces file size and rendering time, making the graphs more manageable
and quicker to load or display.</p>
<p>Ideally, the rasterization only affects the problematic layers of the
plot, while the rest of the plot still uses vector shapes. In tidyplots
this can be achieved with the arguments <code>rasterize = TRUE</code>
and <code>rasterize_dpi</code> which are available in
<code><a href="../reference/add_heatmap.html">add_heatmap()</a></code> and <code><a href="../reference/add_data_points.html">add_data_points()</a></code>
functions.</p>
<p>In the examples below I intentionally chose a low resolution of of 30
to 50 dpi, to make the rastering more obvious. A typical resolution for
print would be 300 dpi.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jbengler/tidyplots" class="external-link">tidyplots</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">gene_expression</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sample</span>, y <span class="op">=</span> <span class="va">external_gene_name</span>, color <span class="op">=</span> <span class="va">expression</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_heatmap.html">add_heatmap</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="st">"row"</span>, rasterize <span class="op">=</span> <span class="cn">TRUE</span>, rasterize_dpi <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/adjust_size.html">adjust_size</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-2-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>And here another example using <code><a href="../reference/add_data_points.html">add_data_points()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatment</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span>rasterize <span class="op">=</span> <span class="cn">TRUE</span>, rasterize_dpi <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-3-1.png" width="1500" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="custom-styling">Custom styling<a class="anchor" aria-label="anchor" href="#custom-styling"></a>
</h2>
<p>Maintaining a consistent look in graphs throughout a paper enhances
readability, supports accurate comparisons, and improves the
communication of the paper’s findings.</p>
<p>In tidyplots you can create a custom style by defining a functional
sequence like the one below, called <code>my_style()</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_style</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/adjust_colors.html">adjust_colors</a></span><span class="op">(</span><span class="va">colors_continuous_bluepinkyellow</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/adjust_font.html">adjust_font</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"mono"</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/remove_x_axis.html">remove_x_axis_ticks</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/remove_y_axis.html">remove_y_axis_ticks</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Each individual plot can then be piped into <code>my_style()</code>
as the final step.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">score</span>, color <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_bar</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points_beeswarm</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">my_style</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-5-1.png" width="1500" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">energy_week</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">power</span>, color <span class="op">=</span> <span class="va">energy_source</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_areastack_absolute.html">add_areastack_relative</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">my_style</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-5-2.png" width="1500" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="data-subsetting">Data subsetting<a class="anchor" aria-label="anchor" href="#data-subsetting"></a>
</h2>
<p>In general, data wrangling should be done before plotting graphs,
including subsetting the data to include only the points that should
appear in the plot.</p>
<p>However, there are times when you have one large data frame that
serves as the basis for multiple plots or when you want to highlight
specific parts of the data while showing the entire dataset in the
background. For these situations, tidyplots enables subsetting the data
during the plotting process.</p>
<p>Let’s say you have a scatter plot of animals displaying their weight
and size, and you want to highlight in red all animals larger than 300
cm.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animals</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight</span>, y <span class="op">=</span> <span class="va">size</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="../reference/all_rows.html">filter_rows</a></span><span class="op">(</span><span class="va">size</span> <span class="op">&gt;</span> <span class="fl">300</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-6-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>In addition, you might want to show the name of the three animals
with the highest body weight.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animals</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight</span>, y <span class="op">=</span> <span class="va">size</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="../reference/all_rows.html">filter_rows</a></span><span class="op">(</span><span class="va">size</span> <span class="op">&gt;</span> <span class="fl">300</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_labels.html">add_data_labels_repel</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="../reference/all_rows.html">max_rows</a></span><span class="op">(</span><span class="va">weight</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, label <span class="op">=</span> <span class="va">animal</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-7-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>You can also adjust the shape used for highlighting.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animals</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight</span>, y <span class="op">=</span> <span class="va">size</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="../reference/all_rows.html">max_rows</a></span><span class="op">(</span><span class="va">weight</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, shape <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-8-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Combining this with the previously described rastering of individual
layers, you can choose to raster all data points, while keeping the
highlight as a vector shape.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animals</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight</span>, y <span class="op">=</span> <span class="va">size</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span>rasterize <span class="op">=</span> <span class="cn">TRUE</span>, rasterize_dpi <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="../reference/all_rows.html">max_rows</a></span><span class="op">(</span><span class="va">weight</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, shape <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-9-1.png" width="1500" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="plotting-pipelines">Plotting pipelines<a class="anchor" aria-label="anchor" href="#plotting-pipelines"></a>
</h2>
<p>A unique feature of tidyplots is, that you can view and save multiple
stages or variations of a plot in a single pipeline by using
<code><a href="../reference/view_plot.html">view_plot()</a></code> and <code><a href="../reference/save_plot.html">save_plot()</a></code>.</p>
<p>Let’s say you gradually build up a plot but want to save all
intermediate stages as individual PDF files.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatment</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_dash</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/save_plot.html">save_plot</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"stage_1.pdf"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/save_plot.html">save_plot</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"stage_2.pdf"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points_beeswarm</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/save_plot.html">save_plot</a></span><span class="op">(</span>filename <span class="op">=</span> <span class="st">"stage_3.pdf"</span><span class="op">)</span></span></code></pre></div>
<p>Or you have a big data frame with multiple genes and you quickly want
to generate plots for two of them.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene_expression</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">expression</span>, color <span class="op">=</span> <span class="va">sample_type</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_dash</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points_beeswarm</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/view_plot.html">view_plot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="../reference/all_rows.html">filter_rows</a></span><span class="op">(</span><span class="va">external_gene_name</span> <span class="op">==</span> <span class="st">"Apol6"</span><span class="op">)</span>, title <span class="op">=</span> <span class="st">"Apol6"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/view_plot.html">view_plot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="../reference/all_rows.html">filter_rows</a></span><span class="op">(</span><span class="va">external_gene_name</span> <span class="op">==</span> <span class="st">"Bsn"</span><span class="op">)</span>, title <span class="op">=</span> <span class="st">"Bsn"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-11-1.png" width="1500" style="display: block; margin: auto;"><img src="Advanced-plotting_files/figure-html/unnamed-chunk-11-2.png" width="1500" style="display: block; margin: auto;"></p>
<p>Note that in this example, the <code>data</code> argument together
with the <code><a href="../reference/all_rows.html">filter_rows()</a></code> function is used to subset the data
to one gene at a time. In addition, the <code>title</code> argument lets
you include a plot title to avoid confusing individual plots.</p>
</div>
<div class="section level2">
<h2 id="paired-data">Paired data<a class="anchor" aria-label="anchor" href="#paired-data"></a>
</h2>
<p>When dealing with paired data, you might wish to connect paired data
points. In the example below, all participants switched the treatment
group after a certain time period. Thus for each participant the dataset
contains a score “on placebo” and a score “on treatment”.</p>
<p>The connecting line can be added by using the <code>group</code>
argument of <code><a href="../reference/add_line.html">add_line()</a></code> to specify the grouping
variable.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatment</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">group</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_dash</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_line.html">add_line</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">participant</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-12-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>As a final step, you might want to rearrange the order of the x-axis
labels to have grouped data points side by side.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatment</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">group</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_dash</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_line.html">add_line</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">participant</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/reorder_x_axis_levels.html">reorder_x_axis_labels</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"C"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-13-1.png" width="1500" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="missing-data">Missing data<a class="anchor" aria-label="anchor" href="#missing-data"></a>
</h2>
<p>Proper handling missing values (<code>NA</code>) is an essential
feature of R. It helps to prevent skewed results and make more reliable
inferences.</p>
<p>However, sometimes the handling of missing values can lead to
unanticipated results. For example, when looking at the proportions of
having zero, two, four or six legs in a (non-representative) dataset of
animals, <code><a href="../reference/add_barstack_absolute.html">add_barstack_absolute()</a></code> delivers some interesting
insights.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animals</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">number_of_legs</span>, color <span class="op">=</span> <span class="va">family</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_barstack_absolute.html">add_barstack_absolute</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-14-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>While mammals in this dataset have either zero, two or four legs,
insects consistently have six legs, respectively. Now, when looking at
the same data with <code><a href="../reference/add_areastack_absolute.html">add_areastack_absolute()</a></code> the picture
becomes a little obscure.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animals</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">number_of_legs</span>, color <span class="op">=</span> <span class="va">family</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_areastack_absolute.html">add_areastack_absolute</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-15-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>What happened? Because all insects have six legs, the function could
not find another point on the x-axis to draw a connecting line and plot
the area underneath. As a result, insects completely disappeared. The
same happened to fish and birds, which always have zero and two legs,
respectively.</p>
<p>What the function needs is the information that insects with less
than six legs are missing in the dataset because they do not exist. Thus
it is save to replace the information <code>count = NA</code> with the
information <code>count = 0</code>.</p>
<p>You can fix the plot by setting <code>replace_na = TRUE</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animals</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">number_of_legs</span>, color <span class="op">=</span> <span class="va">family</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/add_areastack_absolute.html">add_areastack_absolute</a></span><span class="op">(</span>replace_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-16-1.png" width="1500" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="multiplot-layouts">Multiplot layouts<a class="anchor" aria-label="anchor" href="#multiplot-layouts"></a>
</h2>
<p>Often times you have to generate identical plots for many different
subsets of the same dataset. For example, you might look at a gene
expression dataset like <code>gene_expression</code> including many
individual genes.</p>
<p>In such a case you can build your plot as usual using the entire
dataset and then split the plot by the gene name using the
<code><a href="../reference/split_plot.html">split_plot()</a></code> function.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene_expression</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># filter down to 4 genes for demonstration</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">external_gene_name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Apol6"</span>,<span class="st">"Bsn"</span>,<span class="st">"Vgf"</span>,<span class="st">"Mpc2"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># start plotting</span></span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">expression</span>, color <span class="op">=</span> <span class="va">sample_type</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_dash</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points_beeswarm</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_test_pvalue.html">add_test_asterisks</a></span><span class="op">(</span>hide_info <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/adjust_size.html">adjust_size</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">30</span>, height <span class="op">=</span> <span class="fl">25</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/split_plot.html">split_plot</a></span><span class="op">(</span>by <span class="op">=</span> <span class="va">external_gene_name</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-17-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>In case there are too many genes to fit on one page, you can also
spread them across a multipage PDF. To do so, just specify the maximum
number of columns <code>ncol</code> and rows <code>nrow</code> you want
to have on one page.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene_expression</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">expression</span>, color <span class="op">=</span> <span class="va">sample_type</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_dash</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points_beeswarm</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_test_pvalue.html">add_test_asterisks</a></span><span class="op">(</span>hide_info <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/adjust_size.html">adjust_size</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">30</span>, height <span class="op">=</span> <span class="fl">25</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/split_plot.html">split_plot</a></span><span class="op">(</span>by <span class="op">=</span> <span class="va">external_gene_name</span>, ncol <span class="op">=</span> <span class="fl">3</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/save_plot.html">save_plot</a></span><span class="op">(</span><span class="st">"test.pdf"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="orientation">Orientation<a class="anchor" aria-label="anchor" href="#orientation"></a>
</h2>
<p>Some plot elements like bars, areas or curve fits have an orientation
that needs to be inferred from the variables mapped to the
<code>x</code> and <code>y</code> axis. For example, the following code
results in vertical bars.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animals</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">diet</span>, y <span class="op">=</span> <span class="va">weight</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_bar</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-19-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>As expected, swapping the <code>x</code> and <code>y</code> arguments
results in horizontal bars.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animals</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight</span>, y <span class="op">=</span> <span class="va">diet</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_bar</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-20-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>In most cases the auto-detection of the orientation works well. In
case it does not fit your needs, you can manually set the
<code>orientation</code> to either <code>"x"</code> or
<code>"y"</code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time_course</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">score</span>, y <span class="op">=</span> <span class="va">day</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_curve_fit.html">add_curve_fit</a></span><span class="op">(</span>orientation <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_title.html">add_title</a></span><span class="op">(</span><span class="st">"orientation = x"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-21-1.png" width="1500" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time_course</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">score</span>, y <span class="op">=</span> <span class="va">day</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_curve_fit.html">add_curve_fit</a></span><span class="op">(</span>orientation <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_title.html">add_title</a></span><span class="op">(</span><span class="st">"orientation = y"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-21-2.png" width="1500" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="padding">Padding<a class="anchor" aria-label="anchor" href="#padding"></a>
</h2>
<p>Per default, tidyplots gives the data points a little bit of extra
space towards the border of the plot area.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animals</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight</span>, y <span class="op">=</span> <span class="va">speed</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-22-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>This <em>padding</em>, also known as <em>expansion</em> in ggplot2,
is 0.05 by default and can be changes using the
<code><a href="../reference/adjust_padding.html">adjust_padding()</a></code> function.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animals</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight</span>, y <span class="op">=</span> <span class="va">speed</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/adjust_padding.html">adjust_padding</a></span><span class="op">(</span>top <span class="op">=</span> <span class="fl">0.2</span>, right <span class="op">=</span> <span class="fl">0.2</span>, bottom <span class="op">=</span> <span class="fl">0.2</span>, left <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-23-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>To completely remove the padding, you can use the
<code><a href="../reference/remove_padding.html">remove_padding()</a></code> function. However, note that this will
cause extreme values to fall onto the border of the plot area and be
partially cut off.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animals</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight</span>, y <span class="op">=</span> <span class="va">speed</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/remove_padding.html">remove_padding</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-24-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>When using certain types of plot components, tidyplots automatically
adapts the padding to improve the look of the plot. For example, in
<code>bar</code> and <code>area</code> plots the padding between the
<code>bar</code> or <code>area</code> and the axis is removed.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatment</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_bar</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-25-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>You can re-introduce the bottom padding like so.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatment</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_bar</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/adjust_padding.html">adjust_padding</a></span><span class="op">(</span>bottom <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-26-1.png" width="1500" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="dodging">Dodging<a class="anchor" aria-label="anchor" href="#dodging"></a>
</h2>
<p>Dodging refers to the distance between grouped objects. In plots with
at least one discrete axis the default is 0.8 and looks like this.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">dose</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_bar</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-27-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Decreasing the <code>dodge_width</code> in the
<code><a href="../reference/tidyplots-package.html">tidyplots()</a></code> function call decreases the spacing between
grouped bars.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">dose</span>, dodge_width <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_bar</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-28-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Setting <code>dodge_width = 0</code> results in completely
overlapping positions.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">dose</span>, dodge_width <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_bar</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-29-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>In plots with two continuous axes the default
<code>dodge_width</code> is zero. However, you can always override the
default using the <code>dodge_width</code> argument of the
<code><a href="../reference/tidyplot.html">tidyplot()</a></code> function.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time_course</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">day</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_dot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-30-1.png" width="1500" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="coloring">Coloring<a class="anchor" aria-label="anchor" href="#coloring"></a>
</h2>
<p>tidyplots follows are quite straight forward approach when dealing
with color. The variable that should be encoded by colors is passed via
the <code>color</code> argument to the <code><a href="../reference/tidyplot.html">tidyplot()</a></code>
function.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">dose</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_bar</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-31-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>In ggplot2, the plotting package that underlies tidyplots, colors are
little more complicated. ggplot2 distinguishes between the fill color of
an object <code>fill</code> and the stroke color of an object
<code>color</code>. Some objects like bars can have both, while other
objects like lines just have a stroke <code>color</code> but no
<code>fill</code>.</p>
<p>Usually, tidyplots users do not have to care about these details.
Internally, tidyplots matches both <code>fill</code> and
<code>color</code> to the same color. And this is the color that comes
in as the <code>color</code> argument into the <code><a href="../reference/tidyplot.html">tidyplot()</a></code>
function.</p>
<p>In some cases though, you might want to take manual control over the
<code>fill</code> and stroke <code>color</code> of specific objects.</p>
<p>For example, you want to plot a boxplot without the <code>fill</code>
color.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">dose</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_boxplot.html">add_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-32-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Or with a black stroke <code>color</code>.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">dose</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_boxplot.html">add_boxplot</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-33-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Or you want to have black text labels.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">dose</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_bar</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_value</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-34-1.png" width="1500" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="alpha-versus-saturation">Alpha versus saturation<a class="anchor" aria-label="anchor" href="#alpha-versus-saturation"></a>
</h2>
<p>Sometimes you want to decrease the intensity of your colors.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">dose</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/theme_tidyplot.html">theme_minimal_y</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-35-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>One way to do this is to reduce the opacity by decreasing the alpha
argument. Note how the horizontal lines start to shine through the
bars.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">dose</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_bar</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/theme_tidyplot.html">theme_minimal_y</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-36-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>In the <code><a href="../reference/add_mean_bar.html">add_mean_bar()</a></code> family of functions, in
<code><a href="../reference/add_violin.html">add_violin()</a></code> and in <code>add_boxplots()</code> functions,
tidyplots offers one additional method using the <code>saturation</code>
argument.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">dose</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_bar</a></span><span class="op">(</span>saturation <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/theme_tidyplot.html">theme_minimal_y</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-37-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Note how here the saturation is decreased without making the bars
transparent. Thus, the horizontal lines do not shine through the
bars.</p>
</div>
<div class="section level2">
<h2 id="special-characters">Special characters<a class="anchor" aria-label="anchor" href="#special-characters"></a>
</h2>
<p>When it comes to scientific plots, titles often contain special
characters like Greek symbols, subscript or superscript. For this
purpose, tidyplots supports <em>plotmath expressions</em>.</p>
<p>Besides finding out how to use the <a href="https://www.rdocumentation.org/packages/grDevices/versions/3.6.2/topics/plotmath" class="external-link">plotmath
expression syntax</a>, please note that in tidyplots all plotmath
expressions need to start and end with a <code>$</code> character.
Moreover, you can not mix plotmath with plain text in one string,
instead the entire string needs to be a valid plotmath expression that
includes the plain text.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatment</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_bar</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/adjust_title.html">adjust_title</a></span><span class="op">(</span><span class="st">"$H[2]*O$"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/adjust_title.html">adjust_x_axis_title</a></span><span class="op">(</span><span class="st">"$E==m*c^{2}$"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/adjust_title.html">adjust_y_axis_title</a></span><span class="op">(</span><span class="st">"$TNF*alpha~level$"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-38-1.png" width="1500" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="ggplot2-compatibiliy">ggplot2 compatibiliy<a class="anchor" aria-label="anchor" href="#ggplot2-compatibiliy"></a>
</h2>
<p>tidyplots is built on ggplot2, yet the two packages differ in several
key aspects. The most noticeable difference is probably that tidyplots
consistently uses the pipe <code>|&gt;</code> to add plot components
while ggplot uses <code>+</code> .</p>
<p>There is still a certain compatibility of both systems. For example,
you can transform a ggplot to tidyplot using the
<code>as_tidyplot()</code> function.</p>
<p>Also, you can add ggplot code to a tidyplot using the
<code><a href="../reference/add.html">add()</a></code> helper function.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatment</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_bar</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add.html">add</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Advanced-plotting_files/figure-html/unnamed-chunk-39-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>However, be ready to experience unexpected hiccups, when mixing
ggplot and tidyplots, since ensuring compatibility in every edge case
was not a priority when developing the tidyplots package.</p>
</div>
<div class="section level2">
<h2 id="whats-more">What’s more?<a class="anchor" aria-label="anchor" href="#whats-more"></a>
</h2>
<p>To dive deeper into code-based plotting, here a couple of
resources.</p>
<div class="section level3">
<h3 id="tidyplots-documentation">tidyplots documentation<a class="anchor" aria-label="anchor" href="#tidyplots-documentation"></a>
</h3>
<ul>
<li><p><a href="https://jbengler.github.io/tidyplots/reference/index.html">Package
index</a><br>
Overview of all tidyplots functions</p></li>
<li><p><a href="https://jbengler.github.io/tidyplots/articles/tidyplots.html">Get
started</a><br>
Getting started guide</p></li>
<li><p><a href="https://jbengler.github.io/tidyplots/articles/Visualizing-data.html">Visualizing
data</a><br>
Article with examples for common data visualizations</p></li>
<li><p><a href="https://jbengler.github.io/tidyplots/articles/Advanced-plotting.html">Advanced
plotting</a><br>
Article about advanced plotting techniques and workflows</p></li>
<li><p><a href="https://jbengler.github.io/tidyplots/articles/Color-schemes.html">Color
schemes</a><br>
Article about the use of color schemes</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="other-resources">Other resources<a class="anchor" aria-label="anchor" href="#other-resources"></a>
</h3>
<ul>
<li><p><a href="https://rstudio-education.github.io/hopr/" class="external-link">Hands-On
Programming with R</a><br>
Free online book by Garrett Grolemund</p></li>
<li><p><a href="https://r4ds.hadley.nz" class="external-link">R for Data Science</a><br>
Free online book by Hadley Wickham</p></li>
<li><p><a href="https://clauswilke.com/dataviz/" class="external-link">Fundamentals of Data
Visualization</a><br>
Free online book by Claus O. Wilke</p></li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/jbengler" class="external-link">Jan Broder Engler</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
