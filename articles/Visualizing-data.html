<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Visualizing data • tidyplots</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Visualizing data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidyplots</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/tidyplots.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Visualizing-data.html">Visualizing data</a></li>
    <li><a class="dropdown-item" href="../articles/Advanced-plotting.html">Advanced plotting</a></li>
    <li><a class="dropdown-item" href="../articles/Color-schemes.html">Color schemes</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jbengler/tidyplots/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Visualizing data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jbengler/tidyplots/blob/master/vignettes/articles/Visualizing-data.Rmd" class="external-link"><code>vignettes/articles/Visualizing-data.Rmd</code></a></small>
      <div class="d-none name"><code>Visualizing-data.Rmd</code></div>
    </div>

    
    
<div class="lead">
<p>In this article, we will explore the visualization of different types
of datasets using tidyplots. We will cover the plotting of raw data
points, amounts, and heatmaps, as well as measures for central tendency,
dispersion, and uncertainty. We will conclude by visualizing
distributions and proportions, and adding statistical comparisons and
annotations.</p>
</div>
<div class="section level2">
<h2 id="data-points">Data points<a class="anchor" aria-label="anchor" href="#data-points"></a>
</h2>
<p>Plotting the raw data points is probably the most bare bone way to
visualize a dataset. The corresponding function in tidyplots is called
<code><a href="../reference/add_data_points.html">add_data_points()</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jbengler/tidyplots" class="external-link">tidyplots</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">animals</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight</span>, y <span class="op">=</span> <span class="va">size</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-2-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>In the above example some data points appear to overlap other points.
To account for this so called <em>overplotting</em>, you might want to
add a thin white border around the points. This is achieved by setting
the argument <code>white_border = TRUE</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animals</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight</span>, y <span class="op">=</span> <span class="va">size</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span>white_border <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-3-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Another way is to make the points transparent using the
<code>alpha</code> argument.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animals</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight</span>, y <span class="op">=</span> <span class="va">size</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-4-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Or to change the plotting symbol to an open <code>shape</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animals</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight</span>, y <span class="op">=</span> <span class="va">size</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-5-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>However, data points can also be used to plot a <em>discrete
variable</em> against a <em>continuous variable</em>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatment</span>, y <span class="op">=</span> <span class="va">score</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-6-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>To avoid overplotting in this scenario, there are two additional
options. You can add some random noise to the y position, also known as
<em>jitter</em>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatment</span>, y <span class="op">=</span> <span class="va">score</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points_jitter</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-7-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Alternatively, you can use an algorithm that keeps the points
centered and just moves potentially overlapping points to the sides.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatment</span>, y <span class="op">=</span> <span class="va">score</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points_beeswarm</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-8-1.png" width="1500" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="amounts">Amounts<a class="anchor" aria-label="anchor" href="#amounts"></a>
</h2>
<p>For some datasets, it makes sense to <code>count</code> or
<code>sum</code> up data points in order to arrive to conclusions. As
one example, let’s have a look at the <code>spendings</code>
dataset.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spendings</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 19 × 4</span></span></span>
<span><span class="co">#&gt;    date       title            amount category      </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 2023-10-01 Groceries           100 Food          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2023-10-01 Gasoline             40 Transportation</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 2023-10-01 Rent               <span style="text-decoration: underline;">1</span>200 Housing       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 2023-10-02 Electricity          80 Utilities     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2023-10-03 School Supplies      75 Education     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 2023-10-03 Health Insurance    200 Insurance     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2023-10-04 Dining Out           60 Food          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 2023-10-04 Cell Phone Bill      50 Utilities     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 2023-10-05 Groceries            90 Food          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 2023-10-06 Gasoline             40 Transportation</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 2023-10-07 Medical Checkup     150 Health        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 2023-10-07 Dining Out           70 Food          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 2023-10-08 Groceries           110 Food          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 2023-10-08 Internet Bill        60 Utilities     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> 2023-10-09 Entertainment        30 Entertainment </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> 2023-10-10 Groceries            50 Food          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> 2023-10-12 Public Transport     70 Transportation</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> 2023-10-13 Dentist              90 Health        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> 2023-10-15 Car Insurance        40 Insurance</span></span></code></pre></div>
<p>As you can see, this dataset contains family spendings over a time
period of 15 days in October. Here, it might be informative to see which
spending categories are reoccurring and which are just one time
spendings.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spendings</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">category</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_count_bar.html">add_count_bar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-10-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>One thing to note here is that the x-axis labels are overlapping and
are thus unreadable. There are at least two possible solutions for this.
One is to swap the x and y-axis.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spendings</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">category</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_count_bar.html">add_count_bar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-11-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>The other one is to rotate the x-axis labels.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spendings</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">category</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_count_bar.html">add_count_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/adjust_x_axis.html">adjust_x_axis</a></span><span class="op">(</span>rotate_labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-12-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Now we can appreciate that this family had reoccurring spendings for
<em>Food</em> but just one spending for <em>Housing</em>.</p>
<p>Next, we ask the question <em>how much</em> was spend on each of the
categories by plotting the <code>sum</code> amount.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spendings</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">category</span>, y <span class="op">=</span> <span class="va">amount</span>, color <span class="op">=</span> <span class="va">category</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sum_bar.html">add_sum_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/adjust_x_axis.html">adjust_x_axis</a></span><span class="op">(</span>rotate_labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-13-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Note that we had to introduce the argument <code>y = amount</code> in
the <code><a href="../reference/tidyplot.html">tidyplot()</a></code> function to make it clear which variable
should be summed up.</p>
<p>I also added <code>color = category</code> in the
<code><a href="../reference/tidyplot.html">tidyplot()</a></code> function to have the variable
<code>category</code> encoded by different colors.</p>
<p>Since the labels for the variable <code>category</code> are now
duplicated in the plot, one could argue that it would be justified to
remove the duplicated information on the x-axis.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spendings</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">category</span>, y <span class="op">=</span> <span class="va">amount</span>, color <span class="op">=</span> <span class="va">category</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sum_bar.html">add_sum_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/adjust_x_axis.html">adjust_x_axis</a></span><span class="op">(</span>rotate_labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/remove_x_axis.html">remove_x_axis_labels</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/remove_x_axis.html">remove_x_axis_title</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/remove_x_axis.html">remove_x_axis_ticks</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-14-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Note that besides the x-axis labels, I also removed the x-axis ticks
and x-axis title to achieve a cleaner look.</p>
<p>Of course you are free to play around with different graphical
representations of the sum values. Here is an example of a lollipop plot
constructed from a thin <code>bar</code> and a <code>dot</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spendings</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">category</span>, y <span class="op">=</span> <span class="va">amount</span>, color <span class="op">=</span> <span class="va">category</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sum_bar.html">add_sum_bar</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.03</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sum_bar.html">add_sum_dot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sum_bar.html">add_sum_value</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/adjust_x_axis.html">adjust_x_axis</a></span><span class="op">(</span>rotate_labels <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/remove_x_axis.html">remove_x_axis_labels</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/remove_x_axis.html">remove_x_axis_title</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/remove_x_axis.html">remove_x_axis_ticks</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-15-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>I also added the sum value as text label using the
<code><a href="../reference/add_sum_bar.html">add_sum_value()</a></code> function.</p>
</div>
<div class="section level2">
<h2 id="heatmaps">Heatmaps<a class="anchor" aria-label="anchor" href="#heatmaps"></a>
</h2>
<p>Heatmaps are a great way to plot a <em>continuous variable</em>
across two additional <em>variables</em>. To exemplify this, we will
have a look at the <code>gene_expression</code> dataset.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene_expression</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 800</span></span>
<span><span class="co">#&gt; Columns: 11</span></span>
<span><span class="co">#&gt; $ ensembl_gene_id    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "ENSMUSG00000033576"<span style="color: #949494;">, </span>"ENSMUSG00000033576"<span style="color: #949494;">, </span>"ENSMUS…</span></span>
<span><span class="co">#&gt; $ external_gene_name <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Apol6"<span style="color: #949494;">, </span>"Apol6"<span style="color: #949494;">, </span>"Apol6"<span style="color: #949494;">, </span>"Apol6"<span style="color: #949494;">, </span>"Apol6"<span style="color: #949494;">, </span>"Apol6…</span></span>
<span><span class="co">#&gt; $ sample             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Hin_1"<span style="color: #949494;">, </span>"Hin_2"<span style="color: #949494;">, </span>"Hin_3"<span style="color: #949494;">, </span>"Hin_4"<span style="color: #949494;">, </span>"Hin_5"<span style="color: #949494;">, </span>"Ein_1…</span></span>
<span><span class="co">#&gt; $ expression         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2.203755<span style="color: #949494;">, </span>2.203755<span style="color: #949494;">, </span>2.660558<span style="color: #949494;">, </span>2.649534<span style="color: #949494;">, </span>3.442740<span style="color: #949494;">, </span>5…</span></span>
<span><span class="co">#&gt; $ group              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Hin"<span style="color: #949494;">, </span>"Hin"<span style="color: #949494;">, </span>"Hin"<span style="color: #949494;">, </span>"Hin"<span style="color: #949494;">, </span>"Hin"<span style="color: #949494;">, </span>"Ein"<span style="color: #949494;">, </span>"Ein"<span style="color: #949494;">, </span>"E…</span></span>
<span><span class="co">#&gt; $ sample_type        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "input"<span style="color: #949494;">, </span>"input"<span style="color: #949494;">, </span>"input"<span style="color: #949494;">, </span>"input"<span style="color: #949494;">, </span>"input"<span style="color: #949494;">, </span>"input…</span></span>
<span><span class="co">#&gt; $ condition          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "healthy"<span style="color: #949494;">, </span>"healthy"<span style="color: #949494;">, </span>"healthy"<span style="color: #949494;">, </span>"healthy"<span style="color: #949494;">, </span>"health…</span></span>
<span><span class="co">#&gt; $ is_immune_gene     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "no"<span style="color: #949494;">, </span>"no"<span style="color: #949494;">, </span>"no"<span style="color: #949494;">, </span>"no"<span style="color: #949494;">, </span>"no"<span style="color: #949494;">, </span>"no"<span style="color: #949494;">, </span>"no"<span style="color: #949494;">, </span>"no"<span style="color: #949494;">, </span>"no…</span></span>
<span><span class="co">#&gt; $ direction          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "up"<span style="color: #949494;">, </span>"up"<span style="color: #949494;">, </span>"up"<span style="color: #949494;">, </span>"up"<span style="color: #949494;">, </span>"up"<span style="color: #949494;">, </span>"up"<span style="color: #949494;">, </span>"up"<span style="color: #949494;">, </span>"up"<span style="color: #949494;">, </span>"up…</span></span>
<span><span class="co">#&gt; $ log2_foldchange    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 9.395505<span style="color: #949494;">, </span>9.395505<span style="color: #949494;">, </span>9.395505<span style="color: #949494;">, </span>9.395505<span style="color: #949494;">, </span>9.395505<span style="color: #949494;">, </span>9…</span></span>
<span><span class="co">#&gt; $ padj               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 3.793735e-28<span style="color: #949494;">, </span>3.793735e-28<span style="color: #949494;">, </span>3.793735e-28<span style="color: #949494;">, </span>3.793735e…</span></span></code></pre></div>
<p>We will start by plotting the <code>expression</code> values of each
<code>external_gene_name</code> across the <code>sample</code>
variable.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene_expression</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sample</span>, y <span class="op">=</span> <span class="va">external_gene_name</span>, color <span class="op">=</span> <span class="va">expression</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_heatmap.html">add_heatmap</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-17-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>One thing to note here is that the y-axis labels are overlapping. So
let’s increase the height of the plot area from 50 to 100 mm.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene_expression</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sample</span>, y <span class="op">=</span> <span class="va">external_gene_name</span>, color <span class="op">=</span> <span class="va">expression</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_heatmap.html">add_heatmap</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/adjust_size.html">adjust_size</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-18-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>The next thing to note is that some of the rows like <em>Map1a</em>
and <em>Kif1a</em> show very high values while other rows show much
lower values. Let’s apply a classical technique to reserve the color
range for differences within each row. This is done by calculating
<em>row z scores</em> for each row individually. Luckily, tidyplots does
this for us when setting the argument <code>scale = "row"</code> within
the <code><a href="../reference/add_heatmap.html">add_heatmap()</a></code> function call.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene_expression</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sample</span>, y <span class="op">=</span> <span class="va">external_gene_name</span>, color <span class="op">=</span> <span class="va">expression</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_heatmap.html">add_heatmap</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/adjust_size.html">adjust_size</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-19-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Now it much easier to appreciate the dynamics of individual genes
across the samples on the x-axis.</p>
<p>However, the rows appear to be mixed. Some having rather high
expression in the “Eip” samples while others have high value in the
“Hip” samples. Conveniently, there is a variable called
<code>direction</code> in the dataset, which classifies genes as being
either “up” or “down” regulated. Let’s use this variable to sort our
y-axis.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene_expression</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sample</span>, y <span class="op">=</span> <span class="va">external_gene_name</span>, color <span class="op">=</span> <span class="va">expression</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_heatmap.html">add_heatmap</a></span><span class="op">(</span>scale <span class="op">=</span> <span class="st">"row"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/adjust_size.html">adjust_size</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/sort_x_axis_labels.html">sort_y_axis_labels</a></span><span class="op">(</span><span class="va">direction</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-20-1.png" width="1500" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="central-tendency">Central tendency<a class="anchor" aria-label="anchor" href="#central-tendency"></a>
</h2>
<p>In cases with multiple data points per experimental group, the
<code>mean</code> and the <code>median</code> are a great way to compute
a typical center value for the group, also known as central tendency
measure. In tidyplots, these function start with <code>add_mean_</code>
or <code>add_median_</code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatment</span>, y <span class="op">=</span> <span class="va">score</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points_beeswarm</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_dash</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-21-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>The second part of the function name is dedicated to the graphical
representation. These include the representation as <code>bar</code>,
<code>dash</code>, <code>dot</code>, <code>value</code>,
<code>line</code> or <code>area</code>. Of course, these different
representations can also be combined. Like in this case
<code>line</code> and <code>dot</code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time_course</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">day</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_dot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-22-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Or in this case <code>line</code> and <code>area</code>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time_course</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">day</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_area</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-23-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Here is one more example using <code>bar</code> and
<code>value</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatment</span>, y <span class="op">=</span> <span class="va">score</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_value</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-24-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>You could also plot the <code>mean</code> and the <code>median</code>
together to explore in which cases they diverge. In the example below
the <code>mean</code> is shown in orange and the <code>median</code> in
purple.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatment</span>, y <span class="op">=</span> <span class="va">score</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points_beeswarm</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_dash</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_median_bar.html">add_median_dash</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"purple"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-25-1.png" width="1500" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="dispersion-uncertainty">Dispersion &amp; uncertainty<a class="anchor" aria-label="anchor" href="#dispersion-uncertainty"></a>
</h2>
<p>To complement the central tendency measure, it is often helpful to
provide information about the variability or dispersion of the data
points. Such measures include the standard error of the mean
<code>sem</code>, the standard deviation <code>sd</code>, the
<code>range</code> from the highest to the lowest data point and the 95%
confidence interval <code>ci95</code>.</p>
<p>A classical representation of dispersion is an
<code>errorbar</code>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time_course</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">day</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_dot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-26-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Or the use of a semitransparent <code>ribbon</code>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time_course</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">day</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_dot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_ribbon.html">add_sem_ribbon</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-27-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Another widely used alternative, especially for not normally
distributed data is the use of <code>violin</code> or
<code>boxplot</code>. Starting with the <code>violin</code>, the shape
of these plots resembles the underlying distribution of the data
points.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatment</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_violin.html">add_violin</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-28-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>These can be further augmented by adding, for example, the 0.5
quantile and the underlying data points.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatment</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_violin.html">add_violin</a></span><span class="op">(</span>draw_quantiles <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points_beeswarm</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-29-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>The <code>boxplot</code> is the more classical approach, in which the
quantiles are visualized by a box and whiskers.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatment</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_boxplot.html">add_boxplot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-30-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Finally, although it is not strictly a measure of central tendency,
you can fit a curve through your data to derive an abstracted
representation.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">time_course</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">day</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_curve_fit.html">add_curve_fit</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-31-1.png" width="1500" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="distribution">Distribution<a class="anchor" aria-label="anchor" href="#distribution"></a>
</h2>
<p>When looking at a single distribution of values, a classical approach
for visualization is a <code>histogram</code>.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">energy</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">energy</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_histogram.html">add_histogram</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-32-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>If you want to compare multiple distributions, <code>violin</code> or
<code>boxplot</code> are two potential solutions.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">distributions</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">name</span>, y <span class="op">=</span> <span class="va">value</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_violin.html">add_violin</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points_beeswarm</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-33-1.png" width="1500" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="proportion">Proportion<a class="anchor" aria-label="anchor" href="#proportion"></a>
</h2>
<p>Proportional data provides insights into the proportion or percentage
that each individual category contributes to the total. To explore the
visualization of proportional data in tidyplots, let’s introduce the
<code>energy</code> dataset.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">energy</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 344</span></span>
<span><span class="co">#&gt; Columns: 5</span></span>
<span><span class="co">#&gt; $ year          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2002<span style="color: #949494;">, </span>2002<span style="color: #949494;">, </span>2002<span style="color: #949494;">, </span>2002<span style="color: #949494;">, </span>2002<span style="color: #949494;">, </span>2002<span style="color: #949494;">, </span>2002<span style="color: #949494;">, </span>2002<span style="color: #949494;">, </span>2002<span style="color: #949494;">, </span>20…</span></span>
<span><span class="co">#&gt; $ energy_source <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> Biomass<span style="color: #949494;">, </span>Fossil brown coal / lignite<span style="color: #949494;">, </span>Fossil gas<span style="color: #949494;">, </span>Fossil…</span></span>
<span><span class="co">#&gt; $ energy_type   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> Renewable<span style="color: #949494;">, </span>Fossil<span style="color: #949494;">, </span>Fossil<span style="color: #949494;">, </span>Fossil<span style="color: #949494;">, </span>Fossil<span style="color: #949494;">, </span>Renewable<span style="color: #949494;">, </span>Re…</span></span>
<span><span class="co">#&gt; $ energy        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 3.723<span style="color: #949494;">, </span>140.544<span style="color: #949494;">, </span>39.983<span style="color: #949494;">, </span>111.427<span style="color: #949494;">, </span>1.755<span style="color: #949494;">, </span>0.000<span style="color: #949494;">, </span>23.377<span style="color: #949494;">, </span>1…</span></span>
<span><span class="co">#&gt; $ energy_unit   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "TWh"<span style="color: #949494;">, </span>"TWh"<span style="color: #949494;">, </span>"TWh"<span style="color: #949494;">, </span>"TWh"<span style="color: #949494;">, </span>"TWh"<span style="color: #949494;">, </span>"TWh"<span style="color: #949494;">, </span>"TWh"<span style="color: #949494;">, </span>"TWh"<span style="color: #949494;">, </span>…</span></span></code></pre></div>
<p>As you might appreciate, this dataset contains the
<code>energy</code> in terawatt hours (TWh) produced per
<code>energy_source</code> in Germany between <code>year</code> 2002 and
2024. Let’s start with a <code>pie</code> plot.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">energy</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">energy_type</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_pie.html">add_pie</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-35-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>The above plot represents the <code>count</code> of values across the
different <code>energy_type</code> categories.</p>
<p>However, we might be more interested, in the <code>sum</code>
contribution of each <code>energy_type</code> to the total
<code>energy</code> production. Therefore, we have to provide the
variable <code>energy</code> as a <code>y</code> argument to the
<code><a href="../reference/tidyplots-package.html">tidyplots()</a></code> function.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">energy</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">energy</span>, color <span class="op">=</span> <span class="va">energy_type</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_pie.html">add_donut</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-36-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Now we can appreciate the contribution of each energy type. Note that
I also changed the <code>pie</code> for a <code>donut</code> plot, which
is basically a pie chart with a white hole in the center.</p>
<p>The main criticism of <code>pie</code> and <code>donut</code> plots
is that the human brain struggles to accurately interpret the
proportions represented. A slightly better option might be a
<code>barstack</code> plot.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">energy</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">energy</span>, color <span class="op">=</span> <span class="va">energy_type</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_barstack_absolute.html">add_barstack_absolute</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-37-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>However, for a direct comparison, a classical bar plot is probably
still the best option.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">energy</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">energy_type</span>, y <span class="op">=</span> <span class="va">energy</span>, color <span class="op">=</span> <span class="va">energy_type</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sum_bar.html">add_sum_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sum_bar.html">add_sum_value</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/sort_x_axis_labels.html">sort_x_axis_labels</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-38-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Nevertheless, to visualize proportional data across time or another
variable, <code>barstack</code> plots are the way to go.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">energy</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">energy</span>, color <span class="op">=</span> <span class="va">energy_type</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_barstack_absolute.html">add_barstack_absolute</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-39-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>If we want to focus more on the relative instead of the absolute
contribution, we can use the <code><a href="../reference/add_barstack_absolute.html">add_barstack_relative()</a></code>
function.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">energy</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">energy</span>, color <span class="op">=</span> <span class="va">energy_type</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_barstack_absolute.html">add_barstack_relative</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-40-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>A similar plot can be achieved using an <code>areastack</code>.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">energy</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">year</span>, y <span class="op">=</span> <span class="va">energy</span>, color <span class="op">=</span> <span class="va">energy_type</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_areastack_absolute.html">add_areastack_relative</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-41-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>In both plots, the increasing contribution of renewable energy to the
total energy production over time becomes apparent.</p>
<p>This can also be shown using donut plots. However, we need to
downsample the dataset to 4 representative years.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">energy</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># downsample to 4 representative years</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2005</span>, <span class="fl">2010</span>, <span class="fl">2015</span>, <span class="fl">2020</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># start plotting</span></span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">energy</span>, color <span class="op">=</span> <span class="va">energy_type</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_pie.html">add_donut</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/adjust_size.html">adjust_size</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">25</span>, height <span class="op">=</span> <span class="fl">25</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/adjust_colors.html">adjust_colors</a></span><span class="op">(</span>new_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Fossil"</span> <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>                               <span class="st">"Nuclear"</span> <span class="op">=</span> <span class="st">"#F6C54D"</span>,</span>
<span>                               <span class="st">"Renewable"</span> <span class="op">=</span> <span class="st">"#4FAE62"</span>,</span>
<span>                               <span class="st">"Other"</span> <span class="op">=</span> <span class="st">"#C02D45"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span>  </span>
<span>  <span class="fu"><a href="../reference/split_plot.html">split_plot</a></span><span class="op">(</span>by <span class="op">=</span> <span class="va">year</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-42-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Now, let’s examine a related dataset that presents one week of energy
data with higher time resolution.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">energy_week</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">power</span>, color <span class="op">=</span> <span class="va">energy_source</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_areastack_absolute.html">add_areastack_absolute</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-43-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>In this plot, one can appreciate the higher contribution of solar
power during day time in comparison to night time.</p>
<p>Also this plot can be shown as a relative areastack.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">energy_week</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">power</span>, color <span class="op">=</span> <span class="va">energy_source</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_areastack_absolute.html">add_areastack_relative</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-44-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>This illustrates nicely how wind energy compensates for the lack of
solar power during the night. However, when wind is weak, as on
September 10, fossil energy sources need to step in to fill the gap.</p>
</div>
<div class="section level2">
<h2 id="statistical-comparison">Statistical comparison<a class="anchor" aria-label="anchor" href="#statistical-comparison"></a>
</h2>
<p>To test for differences between experimental groups, tidyplots offers
the functions <code><a href="../reference/add_test_pvalue.html">add_test_asterisks()</a></code> and
<code><a href="../reference/add_test_pvalue.html">add_test_pvalue()</a></code>. While the first one includes asterisks
for symbolizing significance.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dose</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">group</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_dash</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_test_pvalue.html">add_test_asterisks</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-45-1.png" width="1500" style="display: block; margin: auto;"></p>
<p><code><a href="../reference/add_test_pvalue.html">add_test_pvalue()</a></code> provides the computed <em>p</em>
value.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dose</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">group</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_dash</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_test_pvalue.html">add_test_pvalue</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-46-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>As you might have noted, when using these functions, a caption is
automatically included that provides details about the statistical
testing performed. The default is a Student’s <em>t</em> test without
multiple comparison adjustment.</p>
<p>Both can be changed by providing the <code>method</code> and
<code>p.adjust.method</code> arguments.</p>
<p>For example, let’s perform a Wilcoxon signed-rank test with
Benjamini–Hochberg adjustment.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dose</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">group</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_dash</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_test_pvalue.html">add_test_pvalue</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"wilcoxon"</span>, p.adjust.method <span class="op">=</span> <span class="st">"BH"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-47-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>It often makes sense to compare all experimental conditions to a
control condition. For example, let’s say treatment “A” is our
control.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatment</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_dash</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_test_pvalue.html">add_test_pvalue</a></span><span class="op">(</span>ref.group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-48-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>In some scenarios you have a mixture of significant and
non-significant <em>p</em> values.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene_expression</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># filter to one gene</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">external_gene_name</span> <span class="op">==</span> <span class="st">"Apol6"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># start plotting</span></span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">expression</span>, color <span class="op">=</span> <span class="va">sample_type</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_dash</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_test_pvalue.html">add_test_pvalue</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-49-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Here you can choose to hide the non-significant <em>p</em> value
using <code>hide.ns = TRUE</code>.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene_expression</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># filter to one gene</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">external_gene_name</span> <span class="op">==</span> <span class="st">"Apol6"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># start plotting</span></span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">expression</span>, color <span class="op">=</span> <span class="va">sample_type</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_dash</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_test_pvalue.html">add_test_pvalue</a></span><span class="op">(</span>hide.ns <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-50-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Finally, if you want to hide the caption with statistical information
you can do this by providing <code>hide_info = TRUE</code>.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene_expression</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># filter to one gene</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">external_gene_name</span> <span class="op">==</span> <span class="st">"Apol6"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># start plotting</span></span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condition</span>, y <span class="op">=</span> <span class="va">expression</span>, color <span class="op">=</span> <span class="va">sample_type</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_dash</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_test_pvalue.html">add_test_pvalue</a></span><span class="op">(</span>hide.ns <span class="op">=</span> <span class="cn">TRUE</span>, hide_info <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-51-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>There are many more things you can do with statistical comparisons.
Just check out the documentation of <code><a href="../reference/add_test_pvalue.html">add_test_pvalue()</a></code> and
the underlying function <code><a href="https://rpkgs.datanovia.com/ggpubr/reference/geom_pwc.html" class="external-link">ggpubr::geom_pwc()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="annotation">Annotation<a class="anchor" aria-label="anchor" href="#annotation"></a>
</h2>
<p>Sometimes you wish to add annotations to provide the reader with
important additional information. For example, tidyplots let’s you add a
<code>title</code> and a <code>caption</code>.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">study</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">treatment</span>, y <span class="op">=</span> <span class="va">score</span>, color <span class="op">=</span> <span class="va">treatment</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_mean_bar.html">add_mean_dash</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_sem_errorbar.html">add_sem_errorbar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_title.html">add_title</a></span><span class="op">(</span><span class="st">"Interesting study"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_title.html">add_caption</a></span><span class="op">(</span><span class="st">"Here is some more detail how the study was performed"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-52-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>In other cases you might want to highlight specific data points or
reference values in the plot. Let’s take the <code>animals</code>
dataset and plot <code>speed</code> versus <code>weight</code>.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animals</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight</span>, y <span class="op">=</span> <span class="va">speed</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-53-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Here it might be interesting to have closer at the extreme values.
First, let’s highlight the heaviest and the fastest animal.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animals</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight</span>, y <span class="op">=</span> <span class="va">speed</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="../reference/all_rows.html">max_rows</a></span><span class="op">(</span><span class="va">weight</span>, <span class="fl">1</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, shape <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="../reference/all_rows.html">max_rows</a></span><span class="op">(</span><span class="va">speed</span>, <span class="fl">1</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, shape <span class="op">=</span> <span class="fl">1</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-54-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Now it would interesting to know the names of these animals. We can
plot the names of all animals.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animals</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight</span>, y <span class="op">=</span> <span class="va">speed</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_labels.html">add_data_labels</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">animal</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-55-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>Note that I provided the <code>label</code> argument to the
<code><a href="../reference/add_data_labels.html">add_data_labels()</a></code> function to indicate the variable in the
dataset that should be used for the text labels.</p>
<p>Another thing to note is that there is quite some overlap of labels
in the lower left of the plot. Let’s try to separate the data labels
using the <code><a href="../reference/add_data_labels.html">add_data_labels_repel()</a></code> function.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animals</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight</span>, y <span class="op">=</span> <span class="va">speed</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_labels.html">add_data_labels_repel</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">animal</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-56-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>While the general idea might have been good, there are still too many
labels to be plotted. So let’s restrict the labels to the 3 heaviest and
the 3 fastest animals.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animals</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight</span>, y <span class="op">=</span> <span class="va">speed</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_labels.html">add_data_labels_repel</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="../reference/all_rows.html">max_rows</a></span><span class="op">(</span><span class="va">weight</span>, <span class="fl">3</span><span class="op">)</span>, <span class="va">animal</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_labels.html">add_data_labels_repel</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="../reference/all_rows.html">max_rows</a></span><span class="op">(</span><span class="va">speed</span>, <span class="fl">3</span><span class="op">)</span>, <span class="va">animal</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-57-1.png" width="1500" style="display: block; margin: auto;"></p>
<p>There is lot tweaking that can be done with repelling data labels.
For more details have a look at the documentation of
<code><a href="../reference/add_data_labels.html">add_data_labels_repel()</a></code>, the underlying function
<code><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">ggrepel::geom_text_repel()</a></code> and <a href="https://ggrepel.slowkow.com/articles/examples" class="external-link">ggrepel
examples</a>.</p>
<p>As one last thing, let’s add some reference lines, to highlight
specific values on the x and y-axis.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">animals</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/tidyplot.html">tidyplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">weight</span>, y <span class="op">=</span> <span class="va">speed</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_reference_lines.html">add_reference_lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">4000</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_points.html">add_data_points</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_labels.html">add_data_labels_repel</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="../reference/all_rows.html">max_rows</a></span><span class="op">(</span><span class="va">weight</span>, <span class="fl">3</span><span class="op">)</span>, <span class="va">animal</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/add_data_labels.html">add_data_labels_repel</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="../reference/all_rows.html">max_rows</a></span><span class="op">(</span><span class="va">speed</span>, <span class="fl">3</span><span class="op">)</span>, <span class="va">animal</span><span class="op">)</span></span></code></pre></div>
<p><img src="Visualizing-data_files/figure-html/unnamed-chunk-58-1.png" width="1500" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="whats-more">What’s more?<a class="anchor" aria-label="anchor" href="#whats-more"></a>
</h2>
<p>To dive deeper into code-based plotting, here a couple of
resources.</p>
<div class="section level3">
<h3 id="tidyplots-documentation">tidyplots documentation<a class="anchor" aria-label="anchor" href="#tidyplots-documentation"></a>
</h3>
<ul>
<li><p><a href="https://jbengler.github.io/tidyplots/reference/index.html">Package
index</a><br>
Overview of all tidyplots functions</p></li>
<li><p><a href="https://jbengler.github.io/tidyplots/articles/tidyplots.html">Get
started</a><br>
Getting started guide</p></li>
<li><p><a href="https://jbengler.github.io/tidyplots/articles/Visualizing-data.html">Visualizing
data</a><br>
Article with examples for common data visualizations</p></li>
<li><p><a href="https://jbengler.github.io/tidyplots/articles/Advanced-plotting.html">Advanced
plotting</a><br>
Article about advanced plotting techniques and workflows</p></li>
<li><p><a href="https://jbengler.github.io/tidyplots/articles/Color-schemes.html">Color
schemes</a><br>
Article about the use of color schemes</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="other-resources">Other resources<a class="anchor" aria-label="anchor" href="#other-resources"></a>
</h3>
<ul>
<li><p><a href="https://rstudio-education.github.io/hopr/" class="external-link">Hands-On
Programming with R</a><br>
Free online book by Garrett Grolemund</p></li>
<li><p><a href="https://r4ds.hadley.nz" class="external-link">R for Data Science</a><br>
Free online book by Hadley Wickham</p></li>
<li><p><a href="https://clauswilke.com/dataviz/" class="external-link">Fundamentals of Data
Visualization</a><br>
Free online book by Claus O. Wilke</p></li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/jbengler" class="external-link">Jan Broder Engler</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
